#include "hydrodynamic_models/actuators/fmi_azimuth_thruster/include/four_quadrant_model_data.hpp"

#include <memory>
#include <stdexcept>

std::unique_ptr<FourQuadrantPropellerCharacteristics> generate_four_quadrant_model(
    const PropellerGeometry& propeller_geometry, const double pitch_scaling_factor)
{
    std::vector<double> AT, BT, AQ, BQ;

    switch (propeller_geometry) {
            // Wageningen proepeller with 3 blades, blade-area ratio 0.65 and pitch-diameter
            // ratio 1.0
        case PropellerGeometry::WAGENINGEN_B3_BAR65_PD1:
            AT = {1.6498e-02, 1.8754e-01,  1.4666e-02,  2.7847e-02, -1.3450e-02, -7.3355e-02, 1.6449e-03,
                  6.1982e-02, -1.3221e-02, -2.3546e-02, 7.3190e-03, 1.6910e-02,  -3.6303e-03, 1.3126e-02,
                  4.4006e-03, -1.3953e-03, -1.8083e-03, 1.1899e-02, -5.0567e-03, -4.4830e-03, 9.6625e-04,
                  6.0140e-03, -1.4015e-03, -6.6617e-03, 2.9043e-03, 2.7327e-03,  -3.3217e-03, -5.3551e-03,
                  2.0456e-03, 5.9079e-04,  -4.2272e-03};
            BT = {0.0000e+00, -7.3236e-01, -1.0800e-02, 8.4217e-02,  -6.6913e-03, 7.4183e-02,  -5.7837e-03, -2.8837e-02,
                  6.0458e-03, 3.1942e-02,  -5.7098e-04, -6.9568e-03, 1.9927e-03,  1.5548e-02,  -1.0376e-03, -1.4300e-02,
                  5.0044e-03, 5.3262e-03,  -4.4117e-03, -8.6731e-03, 2.5883e-03,  -2.8861e-03, -5.2302e-03, -1.5084e-03,
                  3.0460e-03, -4.1341e-03, -4.4725e-03, 2.9332e-03,  9.3120e-04,  -2.9783e-03, 3.4593e-04};
            AQ = {3.3605e-03, 2.7953e-02,  -7.8796e-04, 6.9239e-03, -5.8625e-04, -1.0047e-02, -1.0484e-03,
                  8.1929e-03, -1.8096e-03, -3.1796e-03, 1.3911e-03, 1.3941e-03,  -1.3403e-03, 3.1910e-03,
                  1.1882e-03, -9.3999e-04, -1.1745e-03, 2.2996e-03, 1.2528e-03,  -6.4176e-04, -7.9200e-04,
                  6.8939e-04, 3.3659e-04,  -9.2414e-04, 2.1777e-04, 2.3964e-04,  -3.6577e-04, -6.0258e-04,
                  3.7933e-04, -8.4302e-06, -7.3971e-04};
            BQ = {-0.0000e+00, -1.0791e-01, 3.7911e-04, 1.2147e-02, -2.8089e-03, 1.2642e-02,  -1.4085e-04,
                  -5.1415e-03, -4.4144e-04, 4.8316e-03, 1.5350e-03, -8.3412e-04, -1.2032e-03, 2.2482e-03,
                  5.1464e-04,  -2.1294e-03, 6.4138e-04, 6.1401e-04, -7.4075e-04, -8.3404e-04, 6.7309e-04,
                  -9.5343e-04, -8.1420e-04, 4.1290e-05, 9.3633e-04, -6.7242e-04, -1.1905e-03, 4.1223e-04,
                  6.8135e-04,  -3.5205e-04, -2.0847e-04};
            break;

        // Wageningen proepeller with 4 blades, blade-area ratio 0.55 and pitch-diameter
        // ratio 1.0
        case PropellerGeometry::WAGENINGEN_B4_BAR55_PD1:
            AT = {3.4064e-02, 1.6145e-01,  1.7506e-03,  2.9221e-02, -5.6875e-03, -5.2907e-02, 1.5641e-03,
                  3.9211e-02, -5.0689e-03, -1.4437e-02, 5.5005e-03, 1.1986e-02,  -2.3543e-03, 6.5241e-03,
                  2.8688e-03, 1.7300e-03,  -2.1127e-03, 6.7966e-03, 2.6391e-03,  -1.0945e-03, 2.2240e-04,
                  3.3699e-03, -1.3877e-03, -3.1140e-03, 1.0828e-03, 1.1705e-03,  -4.8567e-04, -1.9210e-03,
                  1.3741e-03, -6.0125e-04, -1.3257e-03};
            BT = {0.0000e+00,  -6.3411e-01, -1.1389e-02, 5.2075e-02, -8.2996e-03, 6.4256e-02,  9.2855e-03,
                  -5.9179e-03, -3.7997e-03, 1.8518e-03,  3.8178e-03, -6.6059e-04, -2.7401e-04, 1.0085e-02,
                  -1.3712e-03, -6.9713e-03, 2.7074e-03,  4.3689e-03, -3.2628e-03, -5.4754e-03, 1.4242e-03,
                  -1.4012e-03, -2.3628e-03, -1.1184e-03, 1.7998e-03, -1.8777e-03, -1.0904e-03, 1.3036e-04,
                  -3.6628e-04, -9.9300e-04, -1.5754e-04};
            AQ = {4.4164e-03,  2.4434e-02,  -3.3492e-03, 4.9793e-03,  1.3605e-03,  -4.6743e-03, -1.3791e-04, 1.9481e-03,
                  -2.6848e-03, 1.0396e-03,  2.2505e-03,  -2.9114e-04, -1.1370e-03, 2.5187e-03,  -2.3806e-04, 4.2229e-06,
                  6.7432e-04,  7.6630e-04,  -6.0254e-04, 1.9228e-04,  6.3017e-04,  3.9738e-05,  -6.6197e-04, 1.9484e-04,
                  2.9096e-04,  -6.9327e-04, -1.5987e-05, 3.4259e-04,  -3.6560e-04, -5.0379e-04, 4.3807e-04};
            BQ = {-0.0000e+00, -8.8771e-02, 2.6891e-03, 5.5156e-03,  -3.0992e-03, 1.2714e-02, 1.5158e-03,
                  -2.8294e-03, -1.1595e-03, 2.8652e-03, 4.6642e-04,  1.1678e-03,  9.1904e-04, -8.6949e-05,
                  -1.4642e-03, -1.2780e-04, 1.3332e-03, -3.9620e-04, -7.5362e-04, 1.9235e-04, -3.9452e-04,
                  -1.0624e-03, 6.5197e-04,  1.8034e-04, -6.1558e-04, -4.4397e-04, 2.7923e-04, -9.7160e-05,
                  -1.9218e-04, 4.1757e-04,  3.0054e-04};
            break;

        // Wageningen proepeller with 4 blades, blade-area ratio 0.70 and pitch-diameter
        // ratio 0.8
        case PropellerGeometry::WAGENINGEN_B4_BAR70_PD08:
            AT = {2.8757e-02,  1.3007e-01,  6.2869e-03, 2.8104e-02,  -1.6832e-02, -4.4894e-02, 3.7703e-03, 3.1647e-02,
                  -1.3492e-03, -1.9905e-02, 1.7576e-03, 1.9750e-02,  -1.1063e-03, -6.9828e-04, 2.5665e-03, 8.0681e-03,
                  -1.8781e-03, 2.9821e-03,  4.8643e-03, 3.3893e-03,  -2.6851e-03, 9.6098e-04,  2.1450e-03, 6.6440e-04,
                  -1.3210e-03, 1.6378e-04,  1.2367e-04, -1.6113e-03, -1.0536e-03, -4.1139e-04, -8.9569e-05};
            BT = {0.0000e+00,  -7.7762e-01, -1.3032e-02, 1.0580e-01,  -1.0413e-02, 4.5769e-02, 1.4296e-02,  -3.9612e-03,
                  -9.9170e-03, 2.0759e-02,  9.0153e-03,  -2.9877e-04, -5.6354e-03, 9.4773e-03, 2.3681e-03,  -5.3204e-03,
                  -7.1537e-04, 5.2768e-03,  1.7400e-04,  -6.8105e-03, -2.0400e-03, 1.4086e-03, -5.7914e-04, -4.4898e-03,
                  -1.1454e-03, -1.2005e-04, -1.1932e-03, -2.4427e-03, 4.9882e-04,  6.3587e-04, -7.3611e-04};
            AQ = {2.5783e-03, 1.5727e-02,  6.8960e-04,  5.4402e-03, -2.4674e-03, -5.0717e-03, 1.1964e-03,
                  3.1161e-03, -1.5838e-03, -1.4925e-03, 9.0898e-04, 1.2135e-03,  -5.0126e-04, 1.4143e-03,
                  1.8873e-04, -1.5422e-04, -1.7294e-04, 1.3330e-03, 2.2620e-04,  -1.4299e-04, 4.5335e-05,
                  4.0051e-04, -2.0629e-04, 6.9705e-05,  1.8254e-04, 5.6307e-05,  -2.4282e-04, -7.9606e-05,
                  6.9503e-05, -8.0075e-05, -4.2156e-05};
            BQ = {-0.0000e+00, -9.3080e-02, 2.0482e-04, 1.3786e-02, -1.5588e-03, 6.8953e-03,  1.9773e-04,
                  -3.1295e-03, 1.1366e-05,  4.0967e-03, 3.2810e-04, -7.9539e-04, 2.6624e-04,  1.4536e-03,
                  -6.8666e-04, -4.5499e-04, 8.4792e-04, 1.5911e-04, -5.9733e-04, -2.5445e-04, 2.1991e-04,
                  -4.7535e-04, -1.5397e-04, 7.3692e-05, 2.2654e-05, -4.7256e-04, -1.3061e-04, 6.1311e-05,
                  -9.7692e-06, -1.3102e-04, 1.9047e-05};
            break;

            // Wageningen proepeller with 4 blades, blade-area ratio 0.70 and pitch-diameter
            // ratio 1.0
        case PropellerGeometry::WAGENINGEN_B4_BAR70_PD1:
            AT = {2.6617e-02,  1.7802e-01,  1.3828e-02, 2.7871e-02,  -1.6240e-02, -5.3084e-02, 1.9180e-03, 3.8318e-02,
                  -2.2892e-03, -1.8656e-02, 3.4900e-03, 2.2321e-02,  -3.5976e-03, 1.3606e-03,  4.7192e-03, 8.7235e-03,
                  -3.5748e-03, 3.5955e-03,  5.2896e-03, 2.1045e-03,  -2.7057e-03, 1.0509e-03,  2.7733e-03, -1.1596e-03,
                  -1.7450e-03, 4.0782e-04,  9.9247e-04, -3.4650e-03, -1.2357e-03, 6.3929e-04,  6.1933e-04};
            BT = {0.0000e+00,  -7.4797e-01, -1.3632e-02, 1.0246e-01,  -1.0865e-02, 4.7346e-02, 1.1355e-02,  -9.3180e-03,
                  -7.2471e-03, 2.3747e-02,  8.6208e-03,  7.0224e-05,  -3.6422e-03, 9.1758e-03, 8.9383e-04,  -5.9364e-03,
                  -7.0954e-04, 4.8825e-03,  -9.0587e-04, -8.1163e-03, -5.6659e-04, 1.2011e-03, -1.3042e-03, -4.8187e-03,
                  4.5412e-04,  -1.9469e-04, -2.1858e-03, -1.6314e-03, 1.4865e-03,  1.0185e-03, -1.6735e-03};
            AQ = {2.2945e-03,  2.6989e-02,  1.8758e-03,  6.3552e-03,  -2.1668e-03, -7.6530e-03, 5.6516e-04, 6.2654e-03,
                  -1.9211e-03, -3.3456e-03, 1.2956e-03,  3.1294e-03,  -1.2475e-03, 1.4351e-03,  8.3201e-04, -3.4868e-05,
                  -8.9981e-04, 1.4247e-03,  1.1064e-03,  -2.7359e-04, -6.7590e-04, 5.7328e-04,  2.2609e-04, -7.0691e-04,
                  3.0228e-05,  4.6043e-04,  -2.5629e-04, -7.6092e-04, -2.6235e-06, 1.9316e-04,  -3.1487e-04};
            BQ = {-0.0000e+00, -1.1038e-01, 5.2852e-04,  1.6544e-02, -1.9290e-03, 8.4480e-03,  9.0714e-04,
                  -3.1042e-03, -6.8648e-04, 4.5196e-03,  1.0928e-03, 4.4966e-05,  -7.2404e-04, 1.5284e-03,
                  2.3983e-04,  -1.6074e-03, 6.6184e-04,  1.2084e-03, -5.8384e-04, -1.3397e-03, 2.9095e-04,
                  8.9605e-05,  -5.4988e-04, -1.4626e-04, 4.8380e-04, -3.8709e-04, -7.2114e-04, 1.3767e-04,
                  4.5823e-04,  -1.0520e-04, -2.7547e-04};
            break;
        default:
            throw std::runtime_error("Invalid propeller geometry.");
    }

    for (size_t i = 0; i < AT.size(); i++) {
        AT[i] = AT[i] * pitch_scaling_factor;
        BT[i] = BT[i] * pitch_scaling_factor;
        AQ[i] = AQ[i] * pitch_scaling_factor;
        BQ[i] = BQ[i] * pitch_scaling_factor;
    }
    const FourierSeries thrust_fourier_series = FourierSeries(AT, BT);
    const FourierSeries torque_fourier_series = FourierSeries(AQ, BQ);

    return std::make_unique<FourQuadrantPropellerCharacteristics>(thrust_fourier_series, torque_fourier_series);
}