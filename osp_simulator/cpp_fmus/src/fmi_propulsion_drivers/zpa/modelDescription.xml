<?xml version="1.0" encoding="utf-8" ?>
<fmiModelDescription
    fmiVersion="2.0"
    modelName="propulsion_interface_modbus_tcp"
    guid="@FMU_UUID@"
    description="FMU for propulsion interface with modbus tcp protocol."
    version="0.0">

    <CoSimulation
        modelIdentifier="propulsion_interface_modbus_tcp"
        canHandleVariableCommunicationStepSize="true"/>

    <UnitDefinitions>
        <Unit name="m">
            <BaseUnit kg="0" m="1" s="0" A="0" K="0" mol="0" cd="0" rad="0" factor="1.0" offset="0.0"/>
        </Unit>
        <Unit name="rad">
            <BaseUnit kg="0" m="0" s="0" A="0" K="0" mol="0" cd="0" rad="1" factor="1.0" offset="0.0"/>
        </Unit>
        <Unit name="m/s">
            <BaseUnit kg="0" m="1" s="-1" A="0" K="0" mol="0" cd="0" rad="0" factor="1.0" offset="0.0"/>
        </Unit>
        <Unit name="rad/s">
            <BaseUnit kg="0" m="0" s="-1" A="0" K="0" mol="0" cd="0" rad="1" factor="1.0" offset="0.0"/>
        </Unit>
        <Unit name="N">
            <BaseUnit kg="1" m="1" s="-2" A="0" K="0" mol="0" cd="0" rad="0" factor="1.0" offset="0.0"/>
        </Unit>
        <Unit name="N.m">
            <BaseUnit kg="1" m="2" s="-2" A="0" K="0" mol="0" cd="0" rad="0" factor="1.0" offset="0.0"/>
        </Unit>
    </UnitDefinitions>
    <ModelVariables>
    <!-- Parameters -->
    <ScalarVariable name="modbus_server_port" valueReference="1" causality="parameter" variability="fixed">
      <Integer start="502"/>
    </ScalarVariable>
    <ScalarVariable name="modbus_server_ip" valueReference="2" causality="parameter" variability="fixed">
      <String start="127.0.0.1"/>
    </ScalarVariable>
    <ScalarVariable name="holding_register_base_address" valueReference="3" causality="parameter" variability="fixed">
      <Integer start="100"/>
    </ScalarVariable>
    <ScalarVariable name="num_holding_registers" valueReference="4" causality="parameter" variability="fixed">
      <Integer start="57"/>
    </ScalarVariable>
    <ScalarVariable name="autonomy_system_heartbeat_signal_address" valueReference="5" causality="parameter" variability="fixed">
      <Integer start="100"/>
    </ScalarVariable>
    <ScalarVariable name="autonomy_available_signal_address" valueReference="6" causality="parameter" variability="fixed">
      <Integer start="101"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_rpm_command_signal_address" valueReference="7" causality="parameter" variability="fixed">
      <Integer start="102"/>
    </ScalarVariable>
    <ScalarVariable name="steering_degree_command_signal_address" valueReference="8" causality="parameter" variability="fixed">
      <Integer start="103"/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy_button_signal_address" valueReference="9" causality="parameter" variability="fixed">
      <Integer start="104"/>
    </ScalarVariable>
    <ScalarVariable name="lcp_heartbeat_signal_address" valueReference="10" causality="parameter" variability="fixed">
      <Integer start="150"/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy_signal_address" valueReference="11" causality="parameter" variability="fixed">
      <Integer start="151"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_drive_status_signal_address" valueReference="12" causality="parameter" variability="fixed">
      <Integer start="152"/>
    </ScalarVariable>
    <ScalarVariable name="steering_drive_status_signal_address" valueReference="13" causality="parameter" variability="fixed">
      <Integer start="153"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_rpm_feedback_signal_address" valueReference="14" causality="parameter" variability="fixed">
      <Integer start="154"/>
    </ScalarVariable>
    <ScalarVariable name="steering_degree_feedback_signal_address" valueReference="15" causality="parameter" variability="fixed">
      <Integer start="155"/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy_button_available_signal_address" valueReference="16" causality="parameter" variability="fixed">
      <Integer start="156"/>
    </ScalarVariable>
    <ScalarVariable name="modbus_debug_enable" valueReference="17" causality="parameter" variability="fixed">
      <Boolean start="false"/>
    </ScalarVariable>
    <ScalarVariable name="start_listen_on_init" valueReference="18" causality="parameter" variability="fixed">
      <Boolean start="true"/>
    </ScalarVariable>
    <ScalarVariable name="rpm_scaling_factor" valueReference="19" causality="parameter" variability="fixed">
      <Real start="1.0"/>
    </ScalarVariable>
    <!-- Output -->
    <ScalarVariable name="rpm_cmd" valueReference="20" causality="output">
      <Real/>
    </ScalarVariable>
    <ScalarVariable name="angle_cmd" valueReference="21" causality="output">
      <Real/>
    </ScalarVariable>
    <ScalarVariable name="autonomy_available" valueReference="22" causality="output" variability="discrete">
      <Boolean/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy_button" valueReference="23" causality="output" variability="discrete">
      <Boolean/>
    </ScalarVariable>
    <ScalarVariable name="autonomy_system_heartbeat" valueReference="24" causality="output" variability="discrete">
      <Integer/>
    </ScalarVariable>
    <ScalarVariable name="lcp_heartbeat" valueReference="25" causality="output" variability="discrete">
      <Integer/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy" valueReference="26" causality="output" variability="discrete">
      <Boolean/>
    </ScalarVariable>
    <ScalarVariable name="ready_for_autonomy_button_available" valueReference="27" causality="output" variability="discrete">
      <Boolean/>
    </ScalarVariable>
    <!-- Input -->
    <ScalarVariable name="rpm_fb" valueReference="30" causality="input">
      <Real start="0"/>
    </ScalarVariable>
    <ScalarVariable name="angle_fb" valueReference="31" causality="input">
      <Real start="0"/>
    </ScalarVariable>
    <ScalarVariable name="steering_drive_ready" valueReference="32" causality="input" variability="discrete">
      <Boolean start = "true"/>
    </ScalarVariable>
    <ScalarVariable name="steering_drive_running" valueReference="33" causality="input" variability="discrete">
      <Boolean start = "true"/>
    </ScalarVariable>
    <ScalarVariable name="steering_drive_fault" valueReference="34" causality="input" variability="discrete">
      <Boolean start = "false"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_drive_ready" valueReference="35" causality="input" variability="discrete">
      <Boolean start = "true"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_drive_running" valueReference="36" causality="input" variability="discrete">
      <Boolean start = "true"/>
    </ScalarVariable>
    <ScalarVariable name="propulsion_drive_fault" valueReference="37" causality="input" variability="discrete">
      <Boolean start = "false"/>
    </ScalarVariable>
    <ScalarVariable name="lcp_ready_for_autonomy_condition" valueReference="38" causality="input" variability="discrete">
      <Boolean start = "true"/>
    </ScalarVariable>
    <ScalarVariable name="stop_lcp_heartbeat_user_override" valueReference="39" causality="input" variability="discrete">
      <Boolean start = "false"/>
    </ScalarVariable>


    </ModelVariables>
  <ModelStructure/>
</fmiModelDescription>
